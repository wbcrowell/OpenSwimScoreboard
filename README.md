# OpenSwimScoreboard
<!-- Improved compatibility of back to top link: See: https://github.com/othneildrew/Best-README-Template/pull/73 -->
<a name="readme-top"></a>
<!--
*** Thanks for checking out the Best-README-Template. If you have a suggestion
*** that would make this better, please fork the repo and create a pull request
*** or simply open an issue with the tag "enhancement".
*** Don't forget to give the project a star!
*** Thanks again! Now go create something AMAZING! :D
-->



<!-- PROJECT SHIELDS -->
<!--
*** I'm using markdown "reference style" links for readability.
*** Reference links are enclosed in brackets [ ] instead of parentheses ( ).
*** See the bottom of this document for the declaration of the reference variables
*** for contributors-url, forks-url, etc. This is an optional, concise syntax you may use.
*** https://www.markdownguide.org/basic-syntax/#reference-style-links
[![Contributors][contributors-shield]][contributors-url]
[![Forks][forks-shield]][forks-url]
[![Stargazers][stars-shield]][stars-url]
[![Issues][issues-shield]][issues-url]
[![MIT License][license-shield]][license-url]
-->




<!-- PROJECT LOGO -->
<br />
<div align="center">
  <a href="https://github.com/wbcrowell/OpenSwimScoreboard">
    <img src="icon.png" alt="Logo" width="256" height="256">
  </a>

<h3 align="center">Open Swim Scoreboard</h3>

  <p align="center">
    Turns a Colorado Timing swim scoreboard data feed into an 
    html overlay for use in livestreaming and digital displays
    <br />
    <a href="https://github.com/wbcrowell/OpenSwimScoreboard"><strong>Explore the docs »</strong></a>
    <br />
    <br />
<!--    <a href="https://github.com/wbcrowell/OpenSwimScoreboard">View Demo</a>
    ·
-->    
    <a href="https://github.com/wbcrowell/OpenSwimScoreboard/issues">Report Bug</a>
    ·
    <a href="https://github.com/wbcrowell/OpenSwimScoreboard/issues">Request Feature</a>
  </p>
</div>



<!-- TABLE OF CONTENTS -->
<details>
  <summary>Table of Contents</summary>
  <ol>
    <li>
      <a href="#about-the-project">About The Project</a>
      <ul>
        <li><a href="#built-with">Built With</a></li>
      </ul>
    </li>
    <li>
      <a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#installation">Installation</a></li>
      </ul>
    </li>
    <li><a href="#usage">Usage</a></li>
    <li><a href="#roadmap">Roadmap</a></li>
    <li><a href="#contributing">Contributing</a></li>
    <li><a href="#license">License</a></li>
    <li><a href="#contact">Contact</a></li>
    <li><a href="#acknowledgments">Acknowledgments</a></li>
  </ol>
</details>



<!-- ABOUT THE PROJECT -->
## About The Project

![OSS Screen Shot][product-screenshot-detail]

Open Swim Scoreboard translates serial data feed used by the Colorado Timing System6 to drive a standard swim scoreboard, and uses SignalR, running as a local service, to feed it to browser pages.
It also reads Meet Manager-generated start lists (.scb files), formats them as JSON, and saves the data as JSON inside a javascript wrapper.

Both sets of data are translated into HTML via javascript, enabling a variety of informational and graphic effects for video scoreboards, 
OBS livestreams, etc.

The entire app consists of:
* A Winforms dialog which performs several configuration tasks, monitors performance, and provides a way to shut everything down
* A SignalR hub called ScoreboardHub that runs locally as a service
* An HTML page that displays that receives live data from the ScoreboardHub and turns it into HTML, and some supporting files

**Important:** For simplicity there is no web server built into this app and it runs entirely locally. The HTML page(s) are local files opened by the desired browser.

<p align="right">(<a href="#readme-top">back to top</a>)</p>



### Built With


* [![Bootstrap][Bootstrap.com]][Bootstrap-url]
<p align="right">(<a href="#readme-top">back to top</a>)</p>



<!-- GETTING STARTED -->
## Getting Started

While they can used for a variety of purposes, the HTML pages generated by this application are intended to be used with 
[OBS Studio](https://obsproject.com/) to allow economical, high-quality livestreaming of swimming competitions.

### Prerequisites

Open Swim Scoreboard is a Windows 10/11 application that targets [.NET Core 3.1](https://dotnet.microsoft.com/en-us/download/dotnet/3.1)

You'll also need to **make** a 1/4" male TRS to DB9 cable. It's not hard, but you'll need a soldering iron. 
Rudimentary instructions courtesy of [Andy Martin](https://github.com/STU940652/CTS_Scoreboard).

You'll also need a Colorado Timing System6 for the data feed. Open Swim Scoreboard will likely work work with other CTS console versions, but has only been tested on a System6.

### Installation

This is a personal project, so there's no installer, but you can download the compiled binaries [here](https://drive.google.com/drive/folders/1SboR40AXwv9tc6P45s9SqzhQ0KKlGsnU?usp=sharing). In order for this to work properly:
1. Keep the original directory structure intact. Much of the interface consistes of html files, and they depend on relative references.
2. Do NOT save these files in a program files directory. There's a bit of file writing that needs to happen, and you will probably run into permission issues; it's easier to put them someplace else.

Or you can close this repository and compile it yourself. This is a Visual Studio solution. 

![OSS Screen Shot][product-screenshot]

### Offline Testing

The application can be tested without live scoreboard data by modifying [BackgroundServices](https://github.com/wbcrowell/OpenSwimScoreboard/blob/master/BackgroundServices/ScoreboardBackgroundService.cs). 
Comment out the live DataReader and uncomment FileScoreDataReader. Everything necessary to stream a few minutes of "canned" data, including the data itself, is included in the project.

### Customization
The HTML page used to present the real-time scoreboard can be endlessly customized, depending on the developer's experience with HTML5 and javascript. 
Multiple versions of the same page can be created and run&mdash;simultaneously if needed.

The default HTML scoreboard page is located within the scoreboard_html directory, which also contains other necessary files:
[/scoreboard_html/html.html](https://github.com/wbcrowell/OpenSwimScoreboard/blob/master/scoreboard_html/html.html). Note that that directory also contains 
ten redirect pages, named html[x].html (where x is an integer between 1 and 10, inclusive). The _only_ purpose of these redirect pages is to facilitate 
opening the HTML page from the WinForms dialog, which cannot pass along the query string (which indicates the number of lanes to be displayed) to the default browser.

You can modify the existing html.html page, or you create a new, alternative HTML page with a different name. In so doing, there are a few things to keep in mind...

To create or customize an HTML page, the following are essential:

* A reference to the [ASP.NET SignalR Javascript Client](https://learn.microsoft.com/en-us/aspnet/core/signalr/javascript-client?view=aspnetcore-7.0&tabs=visual-studio),
which allows the SignalR hub to send data to the page in real time.
* A reference to this project's [/scoreboard_html/js/site.js](https://github.com/wbcrowell/OpenSwimScoreboard/blob/master/scoreboard_html/js/site.js)
is not strictly necessary (you can create your own), but makes life **much** easier.
* The scoreboard Hub service transmits updates several times per second. Updates consist of a JSON 
[FormattedScoreboardDataModel](https://github.com/wbcrowell/OpenSwimScoreboard/blob/master/Scoreboard/TimingData/FormattedScoreboardDataModel.cs), having the following properties:
    * meetTitle (string)
    * currentEvent (string) _this is event number_
    * currentHeat (string)
    * currentClock (string)
    * laneNumber (array of string)
    * lanePlace (array of string)
    * laneTime (array of string)


The following are helpful but not essential:

* site.js will automatically look for a parsed list of events, heats, swimmer names and team assignments at /scoreboard_html/scoreboardfiles/session.js. 
That list will automatically load event and swimmer names/teams into the html scoreboard.
(The user is given the option to find and parse this data via the Winforms interface when the app starts.)

* site.js uses the following selectors when updating the html page's scoreboard times and names (where (x) is the lane number):

    |Data               |Selector             |
    |:------------------|:--------------------|
    | Event **number** | .event |
    | Event **name** | .eventName |
    | Heat number | .heat |
    | Current timer | .clock |
    | Lane number | #lane(x) .laneNum |
    | Lane place | #lane(x) .place |
    | Lane time | #lane(x) .time |
    | Swimmer name | #lane(x) .name |
    | Swimmer team | #lane(x) .team|

<p align="right">(<a href="#readme-top">back to top</a>)</p>



<!-- USAGE EXAMPLES -->
## Usage

After installing, connecting, and running Open Swim Scoreboard, the user will be able to open an HTML page with the real-time scoreboard
running. The key intended use is to improve livestreams managed by [OBS Sudio](https://obsproject.com/download), which is a very popular free livestreaming application.

![Product in use][product-in-use]

To use Open SwimScoreboard with OBS Studio:

1. Run Open Swim Scoreboard. A Winforms screen will open.
2. Select the correct number of competition lanes (1-10).
3. To preview the scoreboard, click on the display link. Remember that the scoreboard is designed for a 1920x1080 window, so make the browser nice and big!
4. Go back to the Winforms screen.
5. Click "Copy link."
6. Open OBS Studio.
7. In the "Sources" panel, click the "+" button to add a source.
8. Select "Browser."
9. Name the new browser source something like "Scoreboard," then click "OK."
10. Check "Local file."
11. Paste the link from step 5 into "Local file."
12. Set "Height" to 1080, "Width" to 1920, and uncheck "Use custom frame rate" and "Control audio via OBS."
13. Delete "Custom CSS."
14. Click "OK."
15. If you can't see the scoreboard, try moving it higher in the source list.

**Note:** If you need to refresh the browser source in OBS (perhaps because the number of lanes is wrong or the correct names are not showing), 
either restart OBS or double click the browser source and re-enter the local file address.


<p align="right">(<a href="#readme-top">back to top</a>)</p>



<!-- ROADMAP -->
## Roadmap

- [ ] Serial data readers for Colorado Gen7, Daktronics Omnisport 2000, and any other common timing systems
- [ ] Additional scoreboard designs, including animated SVG scoreboards
- [ ] Switch to a cross-platform interface, so that the application can be run in MacOS and Linux

<p align="right">(<a href="#readme-top">back to top</a>)</p>



<!-- LICENSE -->
## License

Distributed under the MIT License. See `LICENSE.txt` for more information.

<p align="right">(<a href="#readme-top">back to top</a>)</p>



<!-- CONTACT -->
## Contact

Brad Crowell - brad@16elm.com

Project Link: [https://github.com/wbcrowell/OpenSwimScoreboard](https://github.com/wbcrowell/OpenSwimScoreboard)

<p align="right">(<a href="#readme-top">back to top</a>)</p>



<!-- ACKNOWLEDGMENTS -->
## Acknowledgments

* The serial data reader and decoder are in many respects a port to .NET from node.js of the excellent work of [Fabrizio Bertocci](https://github.com/fabriziobertocci/coloradoScoreboard), which is itself based on projects by 
     - [Andy Martin](https://github.com/STU940652/CTS_Scoreboard), 
     - [Herb Brill](https://github.com/hwbrill/vsCTS), and 
     - [Marco Walther](https://marcoscorner.walther-family.org/2015/07/colorado-timing-console-scoreboard-protocol/)
* Initial SignalR broadcast architecture based on server-broadcast-signalr-dotnetcore [SignalR Server Broadcasting Using ASP.NET Core 3.1](https://jacobdixon.uk/2020/03/signalr-server-broadcasting-with-asp-net-core-3-1/)
* Meet Manager is a trademark of Active Network, LLC
* System 6 is a trademark of Colorado Time Systems


<p align="right">(<a href="#readme-top">back to top</a>)</p>



<!-- MARKDOWN LINKS & IMAGES -->
<!-- https://www.markdownguide.org/basic-syntax/#reference-style-links -->
[contributors-shield]: https://img.shields.io/github/contributors/wbcrowell/OpenSwimScoreboard.svg?style=for-the-badge
[contributors-url]: https://github.com/wbcrowell/OpenSwimScoreboard/graphs/contributors
[forks-shield]: https://img.shields.io/github/forks/wbcrowell/OpenSwimScoreboard.svg?style=for-the-badge
[forks-url]: https://github.com/wbcrowell/OpenSwimScoreboard/network/members
[stars-shield]: https://img.shields.io/github/stars/wbcrowell/OpenSwimScoreboard.svg?style=for-the-badge
[stars-url]: https://github.com/wbcrowell/OpenSwimScoreboard/stargazers
[issues-shield]: https://img.shields.io/github/issues/wbcrowell/OpenSwimScoreboard.svg?style=for-the-badge
[issues-url]: https://github.com/wbcrowell/OpenSwimScoreboard/issues
[license-shield]: https://img.shields.io/github/license/wbcrowell/OpenSwimScoreboard.svg?style=for-the-badge
[license-url]: https://github.com/wbcrowell/OpenSwimScoreboard/blob/master/LICENSE
[linkedin-shield]: https://img.shields.io/badge/-LinkedIn-black.svg?style=for-the-badge&logo=linkedin&colorB=555
[linkedin-url]: https://linkedin.com/in/linkedin_username
[product-screenshot]: screenshot.png
[product-screenshot-detail]: screenshot-detail.jpg
[product-in-use]: obs.jpg
[Next.js]: https://img.shields.io/badge/next.js-000000?style=for-the-badge&logo=nextdotjs&logoColor=white
[Next-url]: https://nextjs.org/
[React.js]: https://img.shields.io/badge/React-20232A?style=for-the-badge&logo=react&logoColor=61DAFB
[React-url]: https://reactjs.org/
[Vue.js]: https://img.shields.io/badge/Vue.js-35495E?style=for-the-badge&logo=vuedotjs&logoColor=4FC08D
[Vue-url]: https://vuejs.org/
[Angular.io]: https://img.shields.io/badge/Angular-DD0031?style=for-the-badge&logo=angular&logoColor=white
[Angular-url]: https://angular.io/
[Svelte.dev]: https://img.shields.io/badge/Svelte-4A4A55?style=for-the-badge&logo=svelte&logoColor=FF3E00
[Svelte-url]: https://svelte.dev/
[Laravel.com]: https://img.shields.io/badge/Laravel-FF2D20?style=for-the-badge&logo=laravel&logoColor=white
[Laravel-url]: https://laravel.com
[Bootstrap.com]: https://img.shields.io/badge/Bootstrap-563D7C?style=for-the-badge&logo=bootstrap&logoColor=white
[Bootstrap-url]: https://getbootstrap.com
[JQuery.com]: https://img.shields.io/badge/jQuery-0769AD?style=for-the-badge&logo=jquery&logoColor=white
[JQuery-url]: https://jquery.com 